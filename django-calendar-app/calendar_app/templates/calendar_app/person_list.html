{% extends 'calendar_app/base.html' %}
{% block content %}
<h2>Registered People</h2>
<ul>
    {% for person in people %}
        <li style="margin-bottom: 1em;">
            {% if edit_person_id == person.id %}
                <form method="post" style="margin-bottom:0;">
                    {% csrf_token %}
                    {{ edit_person_form.first_name.label_tag }} {{ edit_person_form.first_name }}
                    {{ edit_person_form.last_name.label_tag }} {{ edit_person_form.last_name }}
                    {{ edit_person_form.phone_number.label_tag }} {{ edit_person_form.phone_number }}
                    {{ edit_person_form.email.label_tag }} {{ edit_person_form.email }}
                    {{ edit_person_form.notes.label_tag }} {{ edit_person_form.notes }}
                    <input type="hidden" name="edit_person_id" value="{{ person.id }}">
                    <button type="submit" name="save_person">Save</button>
                    <a href="{% url 'person_list' %}">Cancel</a>
                </form>
            {% else %}
                <strong>{{ person.first_name }} {{ person.last_name }}</strong>
                <ul>
                    <li><strong>Phone:</strong> {{ person.phone_number|default:"—" }}</li>
                    <li><strong>Email:</strong> {{ person.email|default:"—" }}</li>
                    <li><strong>Notes:</strong> {{ person.notes|linebreaksbr|default:"—" }}</li>
                </ul>
                <form method="post" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="edit_person_id" value="{{ person.id }}">
                    <button type="submit" name="edit_person">Edit</button>
                </form>
                <form method="post" style="display:inline;" onsubmit="return confirm('Delete this person?');">
                    {% csrf_token %}
                    <input type="hidden" name="delete_person_id" value="{{ person.id }}">
                    <button type="submit" name="delete_person">Delete</button>
                </form>
            {% endif %}
        </li>
    {% empty %}
        <li>No people registered yet.</li>
    {% endfor %}
</ul>
{% endblock %}